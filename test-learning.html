<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Mode Test</title>
    <script src="js/learning-scheduler.js"></script>
</head>
<body>
    <h1>Learning Mode Test</h1>
    <div id="test-results"></div>

    <script>
        // Test the learning scheduler
        function runTests() {
            const results = document.getElementById('test-results');
            
            // Test data
            const testCards = [
                {
                    card_id: 'card1',
                    prompt: 'What is 2+2?',
                    response: '4',
                    tags: ['math']
                },
                {
                    card_id: 'card2',
                    prompt: 'What is the capital of France?',
                    response: 'Paris',
                    tags: ['geography']
                },
                {
                    card_id: 'card3',
                    prompt: 'What is H2O?',
                    response: 'Water',
                    tags: ['chemistry']
                }
            ];

            results.innerHTML = '<h2>Test Results:</h2>';

            // Test 1: Initialize learning session
            console.log('Test 1: Initialize learning session');
            const session = LearningScheduler.initializeLearningSession(testCards);
            console.log('Session initialized:', session);
            results.innerHTML += `<p>✓ Session initialized with ${session.cards.length} cards</p>`;

            // Test 2: Get next card
            console.log('Test 2: Get next card');
            const firstCard = LearningScheduler.getNextCard(session);
            console.log('First card:', firstCard);
            results.innerHTML += `<p>✓ First card: ${firstCard.prompt}</p>`;

            // Test 3: Process successful review
            console.log('Test 3: Process successful review');
            const updatedSession1 = LearningScheduler.processCardReview(session, firstCard.card_id, true);
            console.log('After first success:', updatedSession1);
            const cardAfterFirstSuccess = updatedSession1.cards.find(c => c.card_id === firstCard.card_id);
            results.innerHTML += `<p>✓ After first success: sessionSuccessCount = ${cardAfterFirstSuccess.sessionSuccessCount}</p>`;

            // Test 4: Process second successful review (should graduate)
            console.log('Test 4: Process second successful review');
            const updatedSession2 = LearningScheduler.processCardReview(updatedSession1, firstCard.card_id, true);
            console.log('After second success:', updatedSession2);
            const cardAfterSecondSuccess = updatedSession2.cards.find(c => c.card_id === firstCard.card_id);
            results.innerHTML += `<p>✓ After second success: isGraduated = ${cardAfterSecondSuccess.isGraduated}</p>`;

            // Test 5: Get session stats
            console.log('Test 5: Get session stats');
            const stats = LearningScheduler.getSessionStats(updatedSession2);
            console.log('Session stats:', stats);
            results.innerHTML += `<p>✓ Session stats: ${stats.graduatedCards}/${stats.totalCards} graduated (${stats.completionPercentage}%)</p>`;

            // Test 6: Process failed review
            console.log('Test 6: Process failed review');
            const secondCard = LearningScheduler.getNextCard(updatedSession2);
            if (secondCard) {
                const updatedSession3 = LearningScheduler.processCardReview(updatedSession2, secondCard.card_id, false);
                const cardAfterFailure = updatedSession3.cards.find(c => c.card_id === secondCard.card_id);
                results.innerHTML += `<p>✓ After failure: sessionSuccessCount reset to ${cardAfterFailure.sessionSuccessCount}</p>`;
                console.log('After failure:', updatedSession3);
            }

            results.innerHTML += '<p><strong>All tests completed! Check console for detailed logs.</strong></p>';
        }

        // Run tests when page loads
        window.addEventListener('load', runTests);
    </script>
</body>
</html>
